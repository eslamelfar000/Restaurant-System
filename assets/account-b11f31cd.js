import{dp as J,cH as k,aA as P,aB as w,aK as a,aC as T,r as f,aL as V,j as e,aD as I,B as F,eA as K,h as C,eB as Q,T as Z,dR as X,aM as j,S as y,c as D,aN as $,aE as z,aO as O,aP as R,aQ as U,aR as q,aS as G,P as o,c8 as Y,$ as v,I as x,a2 as ee,aZ as se,N as A,l as ae,C as oe,p as ne,i as te,k as re,et as ie,W as ce}from"./index-cc84ccf2.js";import{C as le}from"./custom-breadcrumbs-b22cdd1c.js";import{G as _}from"./Grid2-0dbdf610.js";import"./address-list-dialog-1abb00a3.js";import"./payment-new-card-dialog-f9835f0d.js";import{L as de}from"./LoadingButton-3a963eb4.js";import"./DialogTitle-8d226fc5.js";import"./dialogTitleClasses-51ee09ec.js";import"./DialogContent-7b08e4a9.js";import"./DialogActions-3c586869.js";import"./CircularProgress-6dd3866c.js";function pe(){const{user:s}=J(),r=JSON.parse(localStorage.getItem("settings")),m=window.localStorage.getItem("user_data"),i=k(m),u=P().shape({name:w().required(a("auth-form.name")),phone:w().required(a("auth-form.phone"))}),l={name:(s==null?void 0:s.name)||"",phone:(s==null?void 0:s.phone)||"",photo:(s==null?void 0:s.photo)||""},c=T({resolver:z(u),defaultValues:l}),{setValue:n,handleSubmit:h,formState:{errors:H}}=c,[d,B]=f.useState(null);f.useEffect(()=>{c.setValue("name",(s==null?void 0:s.name)||""),c.setValue("phone",(s==null?void 0:s.phone)||""),c.setValue("photo",d||(s==null?void 0:s.photo))},[s]);const L=f.useCallback(t=>{const p=t[0],W=Object.assign(p,{preview:URL.createObjectURL(p)});p&&B(W)},[]);f.useEffect(()=>{d&&n("photo",d,{shouldValidate:!0})},[n,d]);const{mutate:b,error:E,isError:g,isLoading:S}=V({mutationFn:t=>O.post(`${R}dashboard/restaurant/profile/update`,t,{headers:{"Content-Type":"multipart/form-data","Accept-Language":U.language,Authorization:`Bearer ${i==null?void 0:i.token}`}}),onSuccess:()=>{q(a("update-profile-success")),s==null||s.getData()},onError:()=>{G(a("error"))}}),N=t=>{if(d){const p=new FormData;p.append("name",t==null?void 0:t.name),p.append("phone",t==null?void 0:t.phone),p.append("photo",d),b(p)}else b({name:t==null?void 0:t.name,phone:t==null?void 0:t.phone})};return e.jsx(I,{methods:c,onSubmit:h(N),children:e.jsxs(_,{container:!0,spacing:3,children:[e.jsx(F,{sx:{position:"fixed",zIndex:"1102",top:0,left:0,width:"100%",height:"100%",background:"#00000078",visibility:s!=null&&s.isLoading?"":"hidden",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(K,{})}),e.jsx(_,{xs:12,md:4,children:e.jsx(C,{sx:{py:10,px:3,textAlign:"center"},children:e.jsx(Q,{name:"photo",maxSize:3145728,onDrop:L,helperText:e.jsxs(Z,{variant:"caption",sx:{mt:3,mx:"auto",display:"block",textAlign:"center",color:"text.disabled"},children:["Allowed *.jpeg, *.jpg, *.png, *.gif",e.jsx("br",{})," max size of ",X(3145728)]})})})}),e.jsx(_,{xs:12,md:8,children:e.jsxs(C,{sx:{p:3},children:[e.jsxs(F,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[e.jsx(j,{name:"name",label:a("name")}),e.jsx(j,{name:"phone",label:a("phone")})]}),e.jsx(y,{spacing:3,alignItems:"flex-end",sx:{mt:3},children:e.jsx(D,{type:"submit",variant:"contained",disabled:!!S,children:S?e.jsx($,{color:(r==null?void 0:r.themeMode)==="dark"?"#161C24":"#ffffff",size:23}):a("save-changes")})})]})})]})})}o.object,o.object;o.array,o.func,o.func,o.bool,o.func;o.array,o.array,o.array;o.array;o.array;o.array;o.array,o.array,o.array,o.array;function M({socialLinks:s}){const{enqueueSnackbar:r}=Y(),m={facebook:s.facebook,instagram:s.instagram,linkedin:s.linkedin,twitter:s.twitter},i=T({defaultValues:m}),{handleSubmit:u,formState:{isSubmitting:l}}=i,c=u(async n=>{try{await new Promise(h=>setTimeout(h,500)),r("Update success!"),console.info("DATA",n)}catch(h){console.error(h)}});return e.jsx(I,{methods:i,onSubmit:c,children:e.jsxs(y,{component:C,spacing:3,sx:{p:3},children:[Object.keys(s).map(n=>e.jsx(j,{name:n,InputProps:{startAdornment:e.jsx(v,{position:"start",children:e.jsx(x,{width:24,icon:n==="facebook"&&"eva:facebook-fill"||n==="instagram"&&"ant-design:instagram-filled"||n==="linkedin"&&"eva:linkedin-fill"||n==="twitter"&&"eva:twitter-fill"||"",color:n==="facebook"&&"#1877F2"||n==="instagram"&&"#DF3E30"||n==="linkedin"&&"#006097"||n==="twitter"&&"#1C9CEA"||""})})}},n)),e.jsx(de,{type:"submit",variant:"contained",loading:l,sx:{ml:"auto"},children:"Save Changes"})]})})}M.propTypes={socialLinks:o.object};function me(){const s=ee(),r=JSON.parse(localStorage.getItem("settings")),m=window.localStorage.getItem("user_data"),i=k(m),u=P().shape({old_password:w().required(a("change-pass-form.old-pass")),new_password:w().required(a("change-pass-form.new-pass")).min(6,a("change-pass-form.valid-password")).test("no-match",a("change-pass-form.no-match-old"),(g,{parent:S})=>g!==S.old_password),new_password_confirmation:w().required(a("change-pass-form.confirm-new-pass")).oneOf([se("new_password")],a("change-pass-form.pass-match"))}),l={old_password:"",new_password:"",new_password_confirmation:""},c=T({resolver:z(u),defaultValues:l}),{reset:n,handleSubmit:h,formState:{errors:H}}=c,{mutate:d,error:B,isError:L,isLoading:b}=V({mutationFn:g=>O.post(`${R}dashboard/restaurant/profile/password/update`,g,{headers:{"Content-Type":"multipart/form-data","Accept-Language":U.language,Authorization:`Bearer ${i==null?void 0:i.token}`}}),onSuccess:()=>{n(),q(a("change-pass-form.success"))},onError:()=>{G(a("error"))}}),E=g=>{d(g)};return e.jsx(I,{methods:c,onSubmit:h(E),children:e.jsxs(y,{component:C,spacing:3,sx:{p:3},children:[e.jsx(j,{name:"old_password",type:s.value?"text":"password",label:a("change-pass-form.names.old-pass"),InputProps:{endAdornment:e.jsx(v,{position:"end",children:e.jsx(A,{onClick:s.onToggle,edge:"end",children:e.jsx(x,{icon:s.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),e.jsx(j,{name:"new_password",label:a("change-pass-form.names.new-pass"),type:s.value?"text":"password",InputProps:{endAdornment:e.jsx(v,{position:"end",children:e.jsx(A,{onClick:s.onToggle,edge:"end",children:e.jsx(x,{icon:s.value?"solar:eye-bold":"solar:eye-closed-bold"})})})},helperText:e.jsx(y,{component:"span",direction:"row",alignItems:"center"})}),e.jsx(j,{name:"new_password_confirmation",type:s.value?"text":"password",label:a("change-pass-form.names.confirm-pass"),InputProps:{endAdornment:e.jsx(v,{position:"end",children:e.jsx(A,{onClick:s.onToggle,edge:"end",children:e.jsx(x,{icon:s.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),e.jsx(y,{spacing:3,alignItems:"flex-end",sx:{mt:3},children:e.jsx(D,{type:"submit",variant:"contained",disabled:!!b,children:b?e.jsx($,{color:(r==null?void 0:r.themeMode)==="dark"?"#161C24":"#ffffff",size:23}):a("save-changes")})})]})})}const ue=[{value:"general",label:a("general"),icon:e.jsx(x,{icon:"solar:user-id-bold",width:24})},{value:"social",label:a("social"),icon:e.jsx(x,{icon:"solar:share-bold",width:24})},{value:"security",label:a("security"),icon:e.jsx(x,{icon:"ic:round-vpn-key",width:24})}];function he(){const s=ae(),[r,m]=f.useState("general"),i=window.localStorage.getItem("user_data");k(i);const u=f.useCallback((l,c)=>{m(c)},[]);return e.jsxs(oe,{maxWidth:s.themeStretch?!1:"lg",children:[e.jsx(le,{heading:a("account"),links:[{name:a("dashboard"),href:ne.dashboard.root},{name:a("user")},{name:a("account")}],sx:{mb:{xs:3,md:5}}}),e.jsx(te,{value:r,onChange:u,sx:{mb:{xs:3,md:5}},children:ue.map(l=>e.jsx(re,{label:l.label,icon:l.icon,value:l.value},l.value))}),r==="general"&&e.jsx(pe,{}),r==="social"&&e.jsx(M,{socialLinks:ie.socialLinks}),r==="security"&&e.jsx(me,{})]})}function _e(){return e.jsxs(e.Fragment,{children:[e.jsx(ce,{children:e.jsx("title",{children:" Dashboard: Account Settings"})}),e.jsx(he,{})]})}export{_e as default};
