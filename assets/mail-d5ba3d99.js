import{c6 as U,r as j,c7 as A,j as e,a6 as H,I as a,ad as D,T as f,P as l,S as n,e as S,u as L,c as T,aw as $,a5 as K,A as X,B as M,O as J,$ as Q,N as u,a2 as C,f5 as je,fl as be,w as fe,ct as G,fm as Z,E as ye,bJ as we,bK as ve,K as O,cn as F,dz as ke,L as Ce,by as Ie,bQ as Me,dR as Se,D as _,aT as Te,aU as Le,l as Ee,p as v,C as Ne,fn as Re,W as Fe}from"./index-8dd84c3c.js";import{u as B}from"./index-068424f5.js";import{k as Pe,f as ze}from"./keyBy-de406482.js";import{E as z}from"./empty-content-6586860b.js";import{S as I}from"./Skeleton-0940911f.js";import{M as Ue}from"./markdown-56f97e6d.js";import{T as Ae}from"./text-max-line-93a4dfb8.js";import"./_baseEach-645b37a4.js";import"./_baseIteratee-bd62d4d7.js";import"./_baseToString-849371a0.js";function De(){const s=A.mail.labels,{data:r,isLoading:o,error:c,isValidating:i}=B(s,U);return j.useMemo(()=>({labels:(r==null?void 0:r.labels)||[],labelsLoading:o,labelsError:c,labelsValidating:i,labelsEmpty:!o&&!(r!=null&&r.labels.length)}),[r==null?void 0:r.labels,c,o,i])}function $e(s){const r=s?[A.mail.list,{params:{labelId:s}}]:null,{data:o,isLoading:c,error:i,isValidating:x}=B(r,U);return j.useMemo(()=>{const h=Pe(o==null?void 0:o.mails,"id")||{},m=Object.keys(h)||[];return{mails:{byId:h,allIds:m},mailsLoading:c,mailsError:i,mailsValidating:x,mailsEmpty:!c&&!m.length}},[o==null?void 0:o.mails,i,c,x])}function Be(s){const r=s?[A.mail.details,{params:{mailId:s}}]:null,{data:o,isLoading:c,error:i,isValidating:x}=B(r,U);return j.useMemo(()=>({mail:o==null?void 0:o.mail,mailLoading:c,mailError:i,mailValidating:x}),[o==null?void 0:o.mail,i,c,x])}const Ve={all:"fluent:mail-24-filled",inbox:"solar:inbox-bold",trash:"solar:trash-bin-trash-bold",drafts:"solar:file-text-bold",spam:"solar:danger-bold",sent:"iconamoon:send-fill",starred:"eva:star-fill",important:"material-symbols:label-important-rounded",social:"solar:tag-horizontal-bold-duotone",promotions:"solar:tag-horizontal-bold-duotone",forums:"solar:tag-horizontal-bold-duotone"};function Y({selected:s,label:r,onClickNavItem:o,...c}){const{unreadCount:i,color:x,name:t}=r,h=Ve[r.id];return e.jsxs(H,{disableRipple:!0,onClick:o,sx:{px:0,height:40,color:"text.secondary",...s&&{color:"text.primary"},"&:hover":{bgcolor:"transparent"}},...c,children:[e.jsx(a,{icon:h,width:22,sx:{mr:2,color:x}}),e.jsx(D,{primary:t,primaryTypographyProps:{textTransform:"capitalize",typography:s?"subtitle2":"body2"}}),!!i&&e.jsx(f,{variant:"caption",children:i})]})}Y.propTypes={selected:l.bool,label:l.object,onClickNavItem:l.func};function ee({sx:s,...r}){return e.jsxs(n,{spacing:2,direction:"row",alignItems:"center",sx:{py:1,color:o=>S(o.palette.grey[500],.24),...s},...r,children:[e.jsx(I,{variant:"circular",sx:{width:32,height:32,bgcolor:"currentColor"}}),e.jsx(I,{sx:{width:.5,height:10,bgcolor:"currentColor"}})]})}ee.propTypes={sx:l.object};function se({sx:s,...r}){return e.jsxs(n,{spacing:2,direction:"row",alignItems:"center",sx:{py:1,...s},...r,children:[e.jsx(I,{variant:"circular",sx:{width:40,height:40}}),e.jsxs(n,{spacing:1,flexGrow:1,children:[e.jsx(I,{sx:{width:.75,height:10}}),e.jsx(I,{sx:{width:.5,height:10}})]})]})}se.propTypes={sx:l.object};function oe({loading:s,openNav:r,onCloseNav:o,labels:c,selectedLabelId:i,handleClickLabel:x,onToggleCompose:t}){const h=L("up","md"),m=e.jsx(e.Fragment,{children:[...Array(8)].map((d,y)=>e.jsx(ee,{},y))}),p=e.jsx(e.Fragment,{children:c.map(d=>e.jsx(Y,{label:d,selected:i===d.id,onClickNavItem:()=>{x(d.id)}},d.id))}),g=e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{p:d=>({xs:d.spacing(2.5,2.5,2,2.5),md:d.spacing(2,1.5)})},children:e.jsx(T,{fullWidth:!0,color:"inherit",variant:"contained",startIcon:e.jsx(a,{icon:"solar:pen-bold"}),onClick:t,children:"Compose"})}),e.jsx($,{children:e.jsxs(n,{sx:{px:{xs:3.5,md:2.5}},children:[s&&m,!!c.length&&p]})})]});return h?e.jsx(n,{sx:{width:200,flexShrink:0},children:g}):e.jsx(K,{open:r,onClose:o,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:260}},children:g})}oe.propTypes={handleClickLabel:l.func,labels:l.array,loading:l.bool,onCloseNav:l.func,onToggleCompose:l.func,openNav:l.bool,selectedLabelId:l.string};function re({mail:s,selected:r,onClickMail:o,sx:c,...i}){return e.jsxs(H,{onClick:o,sx:{p:1,mb:.5,borderRadius:1,...r&&{bgcolor:"action.selected"},...c},...i,children:[e.jsx(X,{alt:s.from.name,src:`${s.from.avatarUrl}`,sx:{mr:2},children:s.from.name.charAt(0).toUpperCase()}),e.jsxs(e.Fragment,{children:[e.jsx(D,{primary:s.from.name,primaryTypographyProps:{noWrap:!0,variant:"subtitle2"},secondary:s.message,secondaryTypographyProps:{noWrap:!0,component:"span",variant:s.isUnread?"subtitle2":"body2",color:s.isUnread?"text.primary":"text.secondary"}}),e.jsxs(n,{alignItems:"flex-end",sx:{ml:2,height:44},children:[e.jsx(f,{noWrap:!0,variant:"body2",component:"span",sx:{mb:1.5,fontSize:12,color:"text.disabled"},children:ze(new Date(s.createdAt),{addSuffix:!1})}),!!s.isUnread&&e.jsx(M,{sx:{bgcolor:"info.main",width:8,height:8,borderRadius:"50%"}})]})]})]})}re.propTypes={mail:l.object,onClickMail:l.func,selected:l.bool,sx:l.object};function ne({loading:s,mails:r,openMail:o,onCloseMail:c,onClickMail:i,selectedLabelId:x,selectedMailId:t}){const h=L("up","md"),m=e.jsx(e.Fragment,{children:[...Array(8)].map((d,y)=>e.jsx(se,{},y))}),p=e.jsx(e.Fragment,{children:r.allIds.map(d=>e.jsx(re,{mail:r.byId[d],selected:t===d,onClickMail:()=>{i(d)}},d))}),g=e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{p:2},children:h?e.jsx(J,{placeholder:"Search...",InputProps:{startAdornment:e.jsx(Q,{position:"start",children:e.jsx(a,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}):e.jsx(f,{variant:"h6",sx:{textTransform:"capitalize"},children:x})}),e.jsxs($,{sx:{px:2},children:[s&&m,!!r.allIds.length&&p]})]});return h?e.jsx(n,{sx:{width:320,flexShrink:0,borderRadius:1.5,bgcolor:"background.default"},children:g}):e.jsx(K,{open:o,onClose:c,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:g})}ne.propTypes={loading:l.bool,mails:l.object,onClickMail:l.func,onCloseMail:l.func,openMail:l.bool,selectedLabelId:l.string,selectedMailId:l.string};function ie({onOpenNav:s,onOpenMail:r,...o}){return e.jsxs(n,{spacing:2,direction:"row",alignItems:"center",sx:{py:1},...o,children:[e.jsxs(n,{direction:"row",alignItems:"center",children:[e.jsx(u,{onClick:s,children:e.jsx(a,{icon:"fluent:mail-24-filled"})}),r&&e.jsx(u,{onClick:r,children:e.jsx(a,{icon:"solar:chat-round-dots-bold"})})]}),e.jsx(J,{fullWidth:!0,size:"small",placeholder:"Search...",InputProps:{startAdornment:e.jsx(Q,{position:"start",children:e.jsx(a,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})]})}ie.propTypes={onOpenMail:l.func,onOpenNav:l.func};const q=1998,k=24;function te({onCloseCompose:s}){const r=L("up","sm"),[o,c]=j.useState(""),i=C(),x=j.useCallback(t=>{c(t)},[]);return e.jsxs(je,{children:[(i.value||!r)&&e.jsx(be,{open:!0,sx:{zIndex:q}}),e.jsxs(fe,{sx:{right:0,bottom:0,borderRadius:2,display:"flex",position:"fixed",zIndex:q+1,m:`${k}px`,overflow:"hidden",flexDirection:"column",boxShadow:t=>t.customShadows.dropdown,...i.value&&{m:0,right:k/2,bottom:k/2,width:`calc(100% - ${k}px)`,height:`calc(100% - ${k}px)`}},children:[e.jsxs(n,{direction:"row",alignItems:"center",sx:{bgcolor:"background.neutral",p:t=>t.spacing(1.5,1,1.5,2)},children:[e.jsx(f,{variant:"h6",sx:{flexGrow:1},children:"New Message"}),e.jsx(u,{onClick:i.onToggle,children:e.jsx(a,{icon:i?"eva:collapse-fill":"eva:expand-fill"})}),e.jsx(u,{onClick:s,children:e.jsx(a,{icon:"mingcute:close-line"})})]}),e.jsx(G,{placeholder:"To",endAdornment:e.jsxs(n,{direction:"row",spacing:.5,sx:{typography:"subtitle2"},children:[e.jsx(M,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:"Cc"}),e.jsx(M,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:"Bcc"})]}),sx:{px:2,height:48,borderBottom:t=>`solid 1px ${S(t.palette.grey[500],.08)}`}}),e.jsx(G,{placeholder:"Subject",sx:{px:2,height:48,borderBottom:t=>`solid 1px ${S(t.palette.grey[500],.08)}`}}),e.jsxs(n,{spacing:2,flexGrow:1,sx:{p:2},children:[e.jsx(Z,{simple:!0,id:"compose-mail",value:o,onChange:x,placeholder:"Type a message",sx:{"& .ql-editor":{},...i.value&&{height:1,"& .quill":{height:1},"& .ql-editor":{maxHeight:"unset"}}}}),e.jsxs(n,{direction:"row",alignItems:"center",children:[e.jsxs(n,{direction:"row",alignItems:"center",flexGrow:1,children:[e.jsx(u,{children:e.jsx(a,{icon:"solar:gallery-add-bold"})}),e.jsx(u,{children:e.jsx(a,{icon:"eva:attach-2-fill"})})]}),e.jsx(T,{variant:"contained",color:"primary",endIcon:e.jsx(a,{icon:"iconamoon:send-fill"}),children:"Send"})]})]})]})]})}te.propTypes={onCloseCompose:l.string};function ae({mail:s,renderLabel:r}){const o=C(!0);if(!s)return e.jsx(z,{title:"No Conversation Selected",description:"Select a conversation to read",imgUrl:"/assets/icons/empty/ic_email_selected.svg",sx:{borderRadius:1.5,bgcolor:"background.default"}});const c=e.jsxs(n,{direction:"row",alignItems:"center",flexShrink:0,sx:{height:56,pl:2,pr:1},children:[e.jsx(n,{direction:"row",spacing:1,flexGrow:1,children:s.labelIds.map(p=>{const g=r(p);return g?e.jsx(ye,{sx:{bgcolor:S(g.color,.16),color:d=>d.palette.mode==="light"?we(g.color,.24):ve(g.color,.24)},children:g.name},g.id):null})}),e.jsxs(n,{direction:"row",alignItems:"center",children:[e.jsx(O,{color:"warning",icon:e.jsx(a,{icon:"eva:star-outline"}),checkedIcon:e.jsx(a,{icon:"eva:star-fill"}),checked:s.isStarred}),e.jsx(O,{color:"warning",icon:e.jsx(a,{icon:"material-symbols:label-important-rounded"}),checkedIcon:e.jsx(a,{icon:"material-symbols:label-important-rounded"}),checked:s.isImportant}),e.jsx(F,{title:"Archive",children:e.jsx(u,{children:e.jsx(a,{icon:"solar:archive-down-minimlistic-bold"})})}),e.jsx(F,{title:"Mark Unread",children:e.jsx(u,{children:e.jsx(a,{icon:"fluent:mail-unread-20-filled"})})}),e.jsx(F,{title:"Trash",children:e.jsx(u,{children:e.jsx(a,{icon:"solar:trash-bin-trash-bold"})})}),e.jsx(u,{children:e.jsx(a,{icon:"eva:more-vertical-fill"})})]})]}),i=e.jsxs(n,{spacing:2,direction:"row",flexShrink:0,sx:{p:2},children:[e.jsxs(Ae,{variant:"subtitle2",sx:{flexGrow:1},children:["Re: ",s.subject]}),e.jsxs(n,{spacing:.5,children:[e.jsxs(n,{direction:"row",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(u,{size:"small",children:e.jsx(a,{width:18,icon:"solar:reply-bold"})}),e.jsx(u,{size:"small",children:e.jsx(a,{width:18,icon:"solar:multiple-forward-left-broken"})}),e.jsx(u,{size:"small",children:e.jsx(a,{width:18,icon:"solar:forward-bold"})})]}),e.jsx(f,{variant:"caption",noWrap:!0,sx:{color:"text.disabled"},children:ke(s.createdAt)})]})]}),x=e.jsxs(n,{flexShrink:0,direction:"row",alignItems:"center",sx:{p:p=>p.spacing(2,2,1,2)},children:[e.jsx(X,{alt:s.from.name,src:`${s.from.avatarUrl}`,sx:{mr:2},children:s.from.name.charAt(0).toUpperCase()}),e.jsx(D,{primary:e.jsxs(e.Fragment,{children:[s.from.name,e.jsx(M,{component:"span",sx:{typography:"body2",color:"text.disabled"},children:` <${s.from.email}>`})]}),secondary:e.jsxs(e.Fragment,{children:["To: ",s.to.map(p=>e.jsx(Ce,{sx:{color:"text.secondary"},children:`${p.email}, `},p.email))]}),secondaryTypographyProps:{mt:.5,noWrap:!0,component:"span",typography:"caption"}})]}),t=e.jsxs(n,{spacing:1,sx:{p:1,borderRadius:1,bgcolor:"background.neutral"},children:[e.jsxs(n,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(Ie,{onClick:o.onToggle,sx:{color:"text.secondary",typography:"caption",borderRadius:.5},children:[e.jsx(a,{icon:"eva:attach-2-fill",sx:{mr:.5}}),s.attachments.length," attachments",e.jsx(a,{icon:o.value?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill",width:16,sx:{ml:.5}})]}),e.jsx(T,{startIcon:e.jsx(a,{icon:"eva:cloud-download-fill"}),children:"Download"})]}),e.jsx(Me,{in:o.value,unmountOnExit:!0,timeout:"auto",children:e.jsx(n,{direction:"row",flexWrap:"wrap",spacing:1,children:s.attachments.map(p=>e.jsx(n,{alignItems:"center",justifyContent:"center",sx:{width:40,height:40,flexShrink:0,borderRadius:1,overflow:"hidden",position:"relative",backgroundColor:"background.neutral"},children:e.jsx(Se,{tooltip:!0,imageView:!0,file:p.preview,onDownload:()=>console.info("DOWNLOAD"),sx:{width:24,height:24}})},p.id))})})]}),h=e.jsx(M,{sx:{py:3,overflow:"hidden",flexGrow:1},children:e.jsx($,{children:e.jsx(Ue,{children:s.message,sx:{px:2,"& p":{typography:"body2"}}})})}),m=e.jsxs(n,{spacing:2,sx:{p:p=>p.spacing(0,2,2,2)},children:[e.jsx(Z,{simple:!0,id:"reply-mail"}),e.jsxs(n,{direction:"row",alignItems:"center",children:[e.jsxs(n,{direction:"row",alignItems:"center",flexGrow:1,children:[e.jsx(u,{children:e.jsx(a,{icon:"solar:gallery-add-bold"})}),e.jsx(u,{children:e.jsx(a,{icon:"eva:attach-2-fill"})})]}),e.jsx(T,{variant:"contained",color:"primary",endIcon:e.jsx(a,{icon:"iconamoon:send-fill"}),children:"Send"})]})]});return e.jsxs(n,{flexGrow:1,sx:{width:1,minWidth:0,borderRadius:1.5,bgcolor:"background.default"},children:[c,e.jsx(_,{sx:{borderStyle:"dashed"}}),i,e.jsx(_,{sx:{borderStyle:"dashed"}}),x,!!s.attachments.length&&e.jsxs(n,{sx:{px:2},children:[" ",t," "]}),h,m]})}ae.propTypes={mail:l.object,renderLabel:l.func};const P="inbox";function We(){const s=Te(),r=Le(),o=r.get("label")||P,c=r.get("id")||"",i=L("up","md"),x=Ee(),t=C(),h=C(),m=C(),{labels:p,labelsLoading:g}=De(),{mails:d,mailsLoading:y,mailsError:V,mailsEmpty:E}=$e(o),{mail:le,mailLoading:ce,mailError:W}=Be(c),N=d.allIds[0]||"",de=j.useCallback(()=>{t.value&&t.onFalse(),m.onToggle()},[m,t]),xe=j.useCallback(b=>{if(i||t.onFalse(),b){const w=b!==P?`${v.dashboard.mail}?label=${b}`:v.dashboard.mail;s.push(w)}},[t,s,i]),R=j.useCallback(b=>{i||h.onFalse();const w=o!==P?`${v.dashboard.mail}?id=${b}&label=${o}`:`${v.dashboard.mail}?id=${b}`;s.push(w)},[h,s,o,i]);j.useEffect(()=>{(V||W)&&s.push(v.dashboard.mail)},[W,V,s]),j.useEffect(()=>{!c&&N&&R(N)},[N,R,c]),j.useEffect(()=>{m.value?document.body.style.overflow="hidden":document.body.style.overflow=""},[m.value]);const pe=e.jsx(Re,{sx:{borderRadius:1.5,bgcolor:"background.default"}}),he=e.jsx(z,{title:`Nothing in ${o}`,description:"This folder is empty",imgUrl:"/assets/icons/empty/ic_folder_empty.svg",sx:{borderRadius:1.5,maxWidth:{md:320},bgcolor:"background.default"}}),me=e.jsx(oe,{loading:g,openNav:t.value,onCloseNav:t.onFalse,labels:p,selectedLabelId:o,handleClickLabel:xe,onToggleCompose:de}),ue=e.jsx(ne,{mails:d,loading:y,openMail:h.value,onCloseMail:h.onFalse,onClickMail:R,selectedLabelId:o,selectedMailId:c}),ge=e.jsx(e.Fragment,{children:E?e.jsx(z,{imgUrl:"/assets/icons/empty/ic_email_disabled.svg",sx:{borderRadius:1.5,bgcolor:"background.default",...!i&&{display:"none"}}}):e.jsx(ae,{mail:le,renderLabel:b=>p.filter(w=>w.id===b)[0]})});return e.jsxs(e.Fragment,{children:[e.jsxs(Ne,{maxWidth:x.themeStretch?!1:"xl",children:[e.jsx(f,{variant:"h4",sx:{mb:{xs:3,md:5}},children:"Mail"}),e.jsxs(n,{spacing:1,sx:{p:1,borderRadius:2,position:"relative",overflow:"hidden",bgcolor:"background.neutral"},children:[!i&&e.jsx(ie,{onOpenNav:t.onTrue,onOpenMail:E?null:h.onTrue}),e.jsxs(n,{spacing:1,direction:"row",flexGrow:1,sx:{height:{xs:"72vh"}},children:[me,E?he:ue,ce?pe:ge]})]})]}),m.value&&e.jsx(te,{onCloseCompose:m.onFalse})]})}function Ye(){return e.jsxs(e.Fragment,{children:[e.jsx(Fe,{children:e.jsx("title",{children:" Dashboard: Mail"})}),e.jsx(We,{})]})}export{Ye as default};
