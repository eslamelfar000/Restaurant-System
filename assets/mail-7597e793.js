import{f9 as te,fa as ke,fb as Ce,fc as Me,fd as Se,fe as R,ff as Z,fg as Te,cO as Le,bW as Ee,fh as Ne,c6 as Y,r as b,c7 as K,j as e,a6 as le,I as l,ad as X,T as M,P as c,S as t,e as U,u as F,c as $,aw as J,a5 as ce,A as de,B as D,O as xe,$ as he,N as f,a2 as N,f4 as Ae,fi as De,w as _e,ct as ee,fj as ue,E as Re,bJ as Ue,bK as $e,K as re,cn as G,dB as ze,L as Fe,by as Oe,bQ as Pe,dU as Be,D as se,aT as Ve,aU as We,l as Ge,p as L,C as He,eB as qe,W as Ye}from"./index-7ea3d364.js";import{u as Q}from"./index-2c54f451.js";import{_ as Ke}from"./_baseEach-9667a9e7.js";import{a as Xe}from"./_baseIteratee-c8d46604.js";import{E as q}from"./empty-content-873460d0.js";import{S as A}from"./Skeleton-14119312.js";import{M as Je}from"./markdown-e43c85e2.js";import{T as Qe}from"./text-max-line-62eb4965.js";import"./_baseToString-0d1adebe.js";var oe=1e3*60,z=60*24,ne=z*30,ae=z*365;function Ze(r,o,s){var a,n,d;te(2,arguments);var i=Te(),x=(a=(n=s==null?void 0:s.locale)!==null&&n!==void 0?n:i.locale)!==null&&a!==void 0?a:ke;if(!x.formatDistance)throw new RangeError("locale must contain localize.formatDistance property");var p=Ce(r,o);if(isNaN(p))throw new RangeError("Invalid time value");var h=Me(Se(s),{addSuffix:!!(s!=null&&s.addSuffix),comparison:p}),m,u;p>0?(m=R(o),u=R(r)):(m=R(r),u=R(o));var v=String((d=s==null?void 0:s.roundingMethod)!==null&&d!==void 0?d:"round"),j;if(v==="floor")j=Math.floor;else if(v==="ceil")j=Math.ceil;else if(v==="round")j=Math.round;else throw new RangeError("roundingMethod must be 'floor', 'ceil' or 'round'");var I=u.getTime()-m.getTime(),k=I/oe,O=Z(u)-Z(m),y=(I-O)/oe,C=s==null?void 0:s.unit,g;if(C?g=String(C):k<1?g="second":k<60?g="minute":k<z?g="hour":y<ne?g="day":y<ae?g="month":g="year",g==="second"){var P=j(I/1e3);return x.formatDistance("xSeconds",P,h)}else if(g==="minute"){var S=j(k);return x.formatDistance("xMinutes",S,h)}else if(g==="hour"){var B=j(k/60);return x.formatDistance("xHours",B,h)}else if(g==="day"){var V=j(y/z);return x.formatDistance("xDays",V,h)}else if(g==="month"){var _=j(y/ne);return _===12&&C!=="month"?x.formatDistance("xYears",1,h):x.formatDistance("xMonths",_,h)}else if(g==="year"){var W=j(y/ae);return x.formatDistance("xYears",W,h)}throw new RangeError("unit must be 'second', 'minute', 'hour', 'day', 'month' or 'year'")}function er(r,o){return te(1,arguments),Ze(r,Date.now(),o)}function rr(r,o,s,a){for(var n=-1,d=r==null?0:r.length;++n<d;){var i=r[n];o(a,i,s(i),r)}return a}var sr=rr,or=Ke;function nr(r,o,s,a){return or(r,function(n,d,i){o(a,n,s(n),i)}),a}var ar=nr,ir=sr,tr=ar,lr=Xe,cr=Le;function dr(r,o){return function(s,a){var n=cr(s)?ir:tr,d=o?o():{};return n(s,r,lr(a),d)}}var xr=dr,hr=Ne,ur=xr,pr=ur(function(r,o,s){hr(r,s,o)}),mr=pr;const gr=Ee(mr);function fr(){const r=K.mail.labels,{data:o,isLoading:s,error:a,isValidating:n}=Q(r,Y);return b.useMemo(()=>({labels:(o==null?void 0:o.labels)||[],labelsLoading:s,labelsError:a,labelsValidating:n,labelsEmpty:!s&&!(o!=null&&o.labels.length)}),[o==null?void 0:o.labels,a,s,n])}function jr(r){const o=r?[K.mail.list,{params:{labelId:r}}]:null,{data:s,isLoading:a,error:n,isValidating:d}=Q(o,Y);return b.useMemo(()=>{const x=gr(s==null?void 0:s.mails,"id")||{},p=Object.keys(x)||[];return{mails:{byId:x,allIds:p},mailsLoading:a,mailsError:n,mailsValidating:d,mailsEmpty:!a&&!p.length}},[s==null?void 0:s.mails,n,a,d])}function br(r){const o=r?[K.mail.details,{params:{mailId:r}}]:null,{data:s,isLoading:a,error:n,isValidating:d}=Q(o,Y);return b.useMemo(()=>({mail:s==null?void 0:s.mail,mailLoading:a,mailError:n,mailValidating:d}),[s==null?void 0:s.mail,n,a,d])}const vr={all:"fluent:mail-24-filled",inbox:"solar:inbox-bold",trash:"solar:trash-bin-trash-bold",drafts:"solar:file-text-bold",spam:"solar:danger-bold",sent:"iconamoon:send-fill",starred:"eva:star-fill",important:"material-symbols:label-important-rounded",social:"solar:tag-horizontal-bold-duotone",promotions:"solar:tag-horizontal-bold-duotone",forums:"solar:tag-horizontal-bold-duotone"};function pe({selected:r,label:o,onClickNavItem:s,...a}){const{unreadCount:n,color:d,name:i}=o,x=vr[o.id];return e.jsxs(le,{disableRipple:!0,onClick:s,sx:{px:0,height:40,color:"text.secondary",...r&&{color:"text.primary"},"&:hover":{bgcolor:"transparent"}},...a,children:[e.jsx(l,{icon:x,width:22,sx:{mr:2,color:d}}),e.jsx(X,{primary:i,primaryTypographyProps:{textTransform:"capitalize",typography:r?"subtitle2":"body2"}}),!!n&&e.jsx(M,{variant:"caption",children:n})]})}pe.propTypes={selected:c.bool,label:c.object,onClickNavItem:c.func};function me({sx:r,...o}){return e.jsxs(t,{spacing:2,direction:"row",alignItems:"center",sx:{py:1,color:s=>U(s.palette.grey[500],.24),...r},...o,children:[e.jsx(A,{variant:"circular",sx:{width:32,height:32,bgcolor:"currentColor"}}),e.jsx(A,{sx:{width:.5,height:10,bgcolor:"currentColor"}})]})}me.propTypes={sx:c.object};function ge({sx:r,...o}){return e.jsxs(t,{spacing:2,direction:"row",alignItems:"center",sx:{py:1,...r},...o,children:[e.jsx(A,{variant:"circular",sx:{width:40,height:40}}),e.jsxs(t,{spacing:1,flexGrow:1,children:[e.jsx(A,{sx:{width:.75,height:10}}),e.jsx(A,{sx:{width:.5,height:10}})]})]})}ge.propTypes={sx:c.object};function fe({loading:r,openNav:o,onCloseNav:s,labels:a,selectedLabelId:n,handleClickLabel:d,onToggleCompose:i}){const x=F("up","md"),p=e.jsx(e.Fragment,{children:[...Array(8)].map((u,v)=>e.jsx(me,{},v))}),h=e.jsx(e.Fragment,{children:a.map(u=>e.jsx(pe,{label:u,selected:n===u.id,onClickNavItem:()=>{d(u.id)}},u.id))}),m=e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{p:u=>({xs:u.spacing(2.5,2.5,2,2.5),md:u.spacing(2,1.5)})},children:e.jsx($,{fullWidth:!0,color:"inherit",variant:"contained",startIcon:e.jsx(l,{icon:"solar:pen-bold"}),onClick:i,children:"Compose"})}),e.jsx(J,{children:e.jsxs(t,{sx:{px:{xs:3.5,md:2.5}},children:[r&&p,!!a.length&&h]})})]});return x?e.jsx(t,{sx:{width:200,flexShrink:0},children:m}):e.jsx(ce,{open:o,onClose:s,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:260}},children:m})}fe.propTypes={handleClickLabel:c.func,labels:c.array,loading:c.bool,onCloseNav:c.func,onToggleCompose:c.func,openNav:c.bool,selectedLabelId:c.string};function je({mail:r,selected:o,onClickMail:s,sx:a,...n}){return e.jsxs(le,{onClick:s,sx:{p:1,mb:.5,borderRadius:1,...o&&{bgcolor:"action.selected"},...a},...n,children:[e.jsx(de,{alt:r.from.name,src:`${r.from.avatarUrl}`,sx:{mr:2},children:r.from.name.charAt(0).toUpperCase()}),e.jsxs(e.Fragment,{children:[e.jsx(X,{primary:r.from.name,primaryTypographyProps:{noWrap:!0,variant:"subtitle2"},secondary:r.message,secondaryTypographyProps:{noWrap:!0,component:"span",variant:r.isUnread?"subtitle2":"body2",color:r.isUnread?"text.primary":"text.secondary"}}),e.jsxs(t,{alignItems:"flex-end",sx:{ml:2,height:44},children:[e.jsx(M,{noWrap:!0,variant:"body2",component:"span",sx:{mb:1.5,fontSize:12,color:"text.disabled"},children:er(new Date(r.createdAt),{addSuffix:!1})}),!!r.isUnread&&e.jsx(D,{sx:{bgcolor:"info.main",width:8,height:8,borderRadius:"50%"}})]})]})]})}je.propTypes={mail:c.object,onClickMail:c.func,selected:c.bool,sx:c.object};function be({loading:r,mails:o,openMail:s,onCloseMail:a,onClickMail:n,selectedLabelId:d,selectedMailId:i}){const x=F("up","md"),p=e.jsx(e.Fragment,{children:[...Array(8)].map((u,v)=>e.jsx(ge,{},v))}),h=e.jsx(e.Fragment,{children:o.allIds.map(u=>e.jsx(je,{mail:o.byId[u],selected:i===u,onClickMail:()=>{n(u)}},u))}),m=e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{p:2},children:x?e.jsx(xe,{placeholder:"Search...",InputProps:{startAdornment:e.jsx(he,{position:"start",children:e.jsx(l,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}):e.jsx(M,{variant:"h6",sx:{textTransform:"capitalize"},children:d})}),e.jsxs(J,{sx:{px:2},children:[r&&p,!!o.allIds.length&&h]})]});return x?e.jsx(t,{sx:{width:320,flexShrink:0,borderRadius:1.5,bgcolor:"background.default"},children:m}):e.jsx(ce,{open:s,onClose:a,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:m})}be.propTypes={loading:c.bool,mails:c.object,onClickMail:c.func,onCloseMail:c.func,openMail:c.bool,selectedLabelId:c.string,selectedMailId:c.string};function ve({onOpenNav:r,onOpenMail:o,...s}){return e.jsxs(t,{spacing:2,direction:"row",alignItems:"center",sx:{py:1},...s,children:[e.jsxs(t,{direction:"row",alignItems:"center",children:[e.jsx(f,{onClick:r,children:e.jsx(l,{icon:"fluent:mail-24-filled"})}),o&&e.jsx(f,{onClick:o,children:e.jsx(l,{icon:"solar:chat-round-dots-bold"})})]}),e.jsx(xe,{fullWidth:!0,size:"small",placeholder:"Search...",InputProps:{startAdornment:e.jsx(he,{position:"start",children:e.jsx(l,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})]})}ve.propTypes={onOpenMail:c.func,onOpenNav:c.func};const ie=1998,E=24;function ye({onCloseCompose:r}){const o=F("up","sm"),[s,a]=b.useState(""),n=N(),d=b.useCallback(i=>{a(i)},[]);return e.jsxs(Ae,{children:[(n.value||!o)&&e.jsx(De,{open:!0,sx:{zIndex:ie}}),e.jsxs(_e,{sx:{right:0,bottom:0,borderRadius:2,display:"flex",position:"fixed",zIndex:ie+1,m:`${E}px`,overflow:"hidden",flexDirection:"column",boxShadow:i=>i.customShadows.dropdown,...n.value&&{m:0,right:E/2,bottom:E/2,width:`calc(100% - ${E}px)`,height:`calc(100% - ${E}px)`}},children:[e.jsxs(t,{direction:"row",alignItems:"center",sx:{bgcolor:"background.neutral",p:i=>i.spacing(1.5,1,1.5,2)},children:[e.jsx(M,{variant:"h6",sx:{flexGrow:1},children:"New Message"}),e.jsx(f,{onClick:n.onToggle,children:e.jsx(l,{icon:n?"eva:collapse-fill":"eva:expand-fill"})}),e.jsx(f,{onClick:r,children:e.jsx(l,{icon:"mingcute:close-line"})})]}),e.jsx(ee,{placeholder:"To",endAdornment:e.jsxs(t,{direction:"row",spacing:.5,sx:{typography:"subtitle2"},children:[e.jsx(D,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:"Cc"}),e.jsx(D,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:"Bcc"})]}),sx:{px:2,height:48,borderBottom:i=>`solid 1px ${U(i.palette.grey[500],.08)}`}}),e.jsx(ee,{placeholder:"Subject",sx:{px:2,height:48,borderBottom:i=>`solid 1px ${U(i.palette.grey[500],.08)}`}}),e.jsxs(t,{spacing:2,flexGrow:1,sx:{p:2},children:[e.jsx(ue,{simple:!0,id:"compose-mail",value:s,onChange:d,placeholder:"Type a message",sx:{"& .ql-editor":{},...n.value&&{height:1,"& .quill":{height:1},"& .ql-editor":{maxHeight:"unset"}}}}),e.jsxs(t,{direction:"row",alignItems:"center",children:[e.jsxs(t,{direction:"row",alignItems:"center",flexGrow:1,children:[e.jsx(f,{children:e.jsx(l,{icon:"solar:gallery-add-bold"})}),e.jsx(f,{children:e.jsx(l,{icon:"eva:attach-2-fill"})})]}),e.jsx($,{variant:"contained",color:"primary",endIcon:e.jsx(l,{icon:"iconamoon:send-fill"}),children:"Send"})]})]})]})]})}ye.propTypes={onCloseCompose:c.string};function we({mail:r,renderLabel:o}){const s=N(!0);if(!r)return e.jsx(q,{title:"No Conversation Selected",description:"Select a conversation to read",imgUrl:"/assets/icons/empty/ic_email_selected.svg",sx:{borderRadius:1.5,bgcolor:"background.default"}});const a=e.jsxs(t,{direction:"row",alignItems:"center",flexShrink:0,sx:{height:56,pl:2,pr:1},children:[e.jsx(t,{direction:"row",spacing:1,flexGrow:1,children:r.labelIds.map(h=>{const m=o(h);return m?e.jsx(Re,{sx:{bgcolor:U(m.color,.16),color:u=>u.palette.mode==="light"?Ue(m.color,.24):$e(m.color,.24)},children:m.name},m.id):null})}),e.jsxs(t,{direction:"row",alignItems:"center",children:[e.jsx(re,{color:"warning",icon:e.jsx(l,{icon:"eva:star-outline"}),checkedIcon:e.jsx(l,{icon:"eva:star-fill"}),checked:r.isStarred}),e.jsx(re,{color:"warning",icon:e.jsx(l,{icon:"material-symbols:label-important-rounded"}),checkedIcon:e.jsx(l,{icon:"material-symbols:label-important-rounded"}),checked:r.isImportant}),e.jsx(G,{title:"Archive",children:e.jsx(f,{children:e.jsx(l,{icon:"solar:archive-down-minimlistic-bold"})})}),e.jsx(G,{title:"Mark Unread",children:e.jsx(f,{children:e.jsx(l,{icon:"fluent:mail-unread-20-filled"})})}),e.jsx(G,{title:"Trash",children:e.jsx(f,{children:e.jsx(l,{icon:"solar:trash-bin-trash-bold"})})}),e.jsx(f,{children:e.jsx(l,{icon:"eva:more-vertical-fill"})})]})]}),n=e.jsxs(t,{spacing:2,direction:"row",flexShrink:0,sx:{p:2},children:[e.jsxs(Qe,{variant:"subtitle2",sx:{flexGrow:1},children:["Re: ",r.subject]}),e.jsxs(t,{spacing:.5,children:[e.jsxs(t,{direction:"row",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(f,{size:"small",children:e.jsx(l,{width:18,icon:"solar:reply-bold"})}),e.jsx(f,{size:"small",children:e.jsx(l,{width:18,icon:"solar:multiple-forward-left-broken"})}),e.jsx(f,{size:"small",children:e.jsx(l,{width:18,icon:"solar:forward-bold"})})]}),e.jsx(M,{variant:"caption",noWrap:!0,sx:{color:"text.disabled"},children:ze(r.createdAt)})]})]}),d=e.jsxs(t,{flexShrink:0,direction:"row",alignItems:"center",sx:{p:h=>h.spacing(2,2,1,2)},children:[e.jsx(de,{alt:r.from.name,src:`${r.from.avatarUrl}`,sx:{mr:2},children:r.from.name.charAt(0).toUpperCase()}),e.jsx(X,{primary:e.jsxs(e.Fragment,{children:[r.from.name,e.jsx(D,{component:"span",sx:{typography:"body2",color:"text.disabled"},children:` <${r.from.email}>`})]}),secondary:e.jsxs(e.Fragment,{children:["To: ",r.to.map(h=>e.jsx(Fe,{sx:{color:"text.secondary"},children:`${h.email}, `},h.email))]}),secondaryTypographyProps:{mt:.5,noWrap:!0,component:"span",typography:"caption"}})]}),i=e.jsxs(t,{spacing:1,sx:{p:1,borderRadius:1,bgcolor:"background.neutral"},children:[e.jsxs(t,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(Oe,{onClick:s.onToggle,sx:{color:"text.secondary",typography:"caption",borderRadius:.5},children:[e.jsx(l,{icon:"eva:attach-2-fill",sx:{mr:.5}}),r.attachments.length," attachments",e.jsx(l,{icon:s.value?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill",width:16,sx:{ml:.5}})]}),e.jsx($,{startIcon:e.jsx(l,{icon:"eva:cloud-download-fill"}),children:"Download"})]}),e.jsx(Pe,{in:s.value,unmountOnExit:!0,timeout:"auto",children:e.jsx(t,{direction:"row",flexWrap:"wrap",spacing:1,children:r.attachments.map(h=>e.jsx(t,{alignItems:"center",justifyContent:"center",sx:{width:40,height:40,flexShrink:0,borderRadius:1,overflow:"hidden",position:"relative",backgroundColor:"background.neutral"},children:e.jsx(Be,{tooltip:!0,imageView:!0,file:h.preview,onDownload:()=>console.info("DOWNLOAD"),sx:{width:24,height:24}})},h.id))})})]}),x=e.jsx(D,{sx:{py:3,overflow:"hidden",flexGrow:1},children:e.jsx(J,{children:e.jsx(Je,{children:r.message,sx:{px:2,"& p":{typography:"body2"}}})})}),p=e.jsxs(t,{spacing:2,sx:{p:h=>h.spacing(0,2,2,2)},children:[e.jsx(ue,{simple:!0,id:"reply-mail"}),e.jsxs(t,{direction:"row",alignItems:"center",children:[e.jsxs(t,{direction:"row",alignItems:"center",flexGrow:1,children:[e.jsx(f,{children:e.jsx(l,{icon:"solar:gallery-add-bold"})}),e.jsx(f,{children:e.jsx(l,{icon:"eva:attach-2-fill"})})]}),e.jsx($,{variant:"contained",color:"primary",endIcon:e.jsx(l,{icon:"iconamoon:send-fill"}),children:"Send"})]})]});return e.jsxs(t,{flexGrow:1,sx:{width:1,minWidth:0,borderRadius:1.5,bgcolor:"background.default"},children:[a,e.jsx(se,{sx:{borderStyle:"dashed"}}),n,e.jsx(se,{sx:{borderStyle:"dashed"}}),d,!!r.attachments.length&&e.jsxs(t,{sx:{px:2},children:[" ",i," "]}),x,p]})}we.propTypes={mail:c.object,renderLabel:c.func};const H="inbox";function yr(){const r=Ve(),o=We(),s=o.get("label")||H,a=o.get("id")||"",n=F("up","md"),d=Ge(),i=N(),x=N(),p=N(),{labels:h,labelsLoading:m}=fr(),{mails:u,mailsLoading:v,mailsError:j,mailsEmpty:I}=jr(s),{mail:k,mailLoading:O,mailError:y}=br(a),C=u.allIds[0]||"",g=b.useCallback(()=>{i.value&&i.onFalse(),p.onToggle()},[p,i]),P=b.useCallback(w=>{if(n||i.onFalse(),w){const T=w!==H?`${L.dashboard.mail}?label=${w}`:L.dashboard.mail;r.push(T)}},[i,r,n]),S=b.useCallback(w=>{n||x.onFalse();const T=s!==H?`${L.dashboard.mail}?id=${w}&label=${s}`:`${L.dashboard.mail}?id=${w}`;r.push(T)},[x,r,s,n]);b.useEffect(()=>{(j||y)&&r.push(L.dashboard.mail)},[y,j,r]),b.useEffect(()=>{!a&&C&&S(C)},[C,S,a]),b.useEffect(()=>{p.value?document.body.style.overflow="hidden":document.body.style.overflow=""},[p.value]);const B=e.jsx(qe,{sx:{borderRadius:1.5,bgcolor:"background.default"}}),V=e.jsx(q,{title:`Nothing in ${s}`,description:"This folder is empty",imgUrl:"/assets/icons/empty/ic_folder_empty.svg",sx:{borderRadius:1.5,maxWidth:{md:320},bgcolor:"background.default"}}),_=e.jsx(fe,{loading:m,openNav:i.value,onCloseNav:i.onFalse,labels:h,selectedLabelId:s,handleClickLabel:P,onToggleCompose:g}),W=e.jsx(be,{mails:u,loading:v,openMail:x.value,onCloseMail:x.onFalse,onClickMail:S,selectedLabelId:s,selectedMailId:a}),Ie=e.jsx(e.Fragment,{children:I?e.jsx(q,{imgUrl:"/assets/icons/empty/ic_email_disabled.svg",sx:{borderRadius:1.5,bgcolor:"background.default",...!n&&{display:"none"}}}):e.jsx(we,{mail:k,renderLabel:w=>h.filter(T=>T.id===w)[0]})});return e.jsxs(e.Fragment,{children:[e.jsxs(He,{maxWidth:d.themeStretch?!1:"xl",children:[e.jsx(M,{variant:"h4",sx:{mb:{xs:3,md:5}},children:"Mail"}),e.jsxs(t,{spacing:1,sx:{p:1,borderRadius:2,position:"relative",overflow:"hidden",bgcolor:"background.neutral"},children:[!n&&e.jsx(ve,{onOpenNav:i.onTrue,onOpenMail:I?null:x.onTrue}),e.jsxs(t,{spacing:1,direction:"row",flexGrow:1,sx:{height:{xs:"72vh"}},children:[_,I?V:W,O?B:Ie]})]})]}),p.value&&e.jsx(ye,{onCloseCompose:p.onFalse})]})}function Nr(){return e.jsxs(e.Fragment,{children:[e.jsx(Ye,{children:e.jsx("title",{children:" Dashboard: Mail"})}),e.jsx(yr,{})]})}export{Nr as default};
