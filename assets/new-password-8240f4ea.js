import{aV as A,aY as N,a2 as R,aA as T,aB as n,aK as s,aZ as $,aC as q,aL as _,r as h,j as e,S as x,aM as i,aW as B,$ as f,N as g,I as d,c as H,aN as V,T as c,L as w,R as M,p as O,a_ as W,aD as z,aE as D,aO as J,aP as K,aQ as Q,aR as Y,aS as Z,W as G}from"./index-cc84ccf2.js";import{a as U}from"./use-countdown-42011b09.js";import{u as X}from"./send-code-b18840e7.js";import"./axios_config-cbf03a73.js";function ee(){const{newPassword:se,forgotPassword:j}=A(),r=JSON.parse(localStorage.getItem("settings")),l=N(),t=window.localStorage.getItem("code-email"),a=R(),{countdown:y,counting:u,startCountdown:m}=U(60),b=T().shape({otp:n().required(s("auth-form.code")).min(8,s("auth-form.valid-code")),email:n().required(s("auth-form.email")).email(s("auth-form.valid-email")),password:n().required(s("auth-form.new-password")).min(8,s("auth-form.valid-password")),password_confirmation:n().required(s("auth-form.confirm-new-password")).oneOf([$("password")],s("auth-form.pass-match"))}),v={otp:"",email:t||"",password:"",password_confirmation:""},p=q({mode:"onChange",resolver:D(b),defaultValues:v}),{watch:ae,handleSubmit:S,formState:{errors:oe}}=p,{mutate:C}=X(),{mutate:I,error:ne,isError:re,isLoading:P}=_({mutationFn:o=>J.post(`${K}dashboard/restaurant/user/auth/changepassword`,o,{headers:{"Content-Type":"application/json","Accept-Language":Q.language}}),onSuccess:()=>{l("/"),Y(s("send-code-success")),window.localStorage.removeItem("code-email")},onError:o=>{Z(s("send-code-error"))}}),k=o=>{I(o)},F=h.useCallback(async()=>{try{m(),C({email:t})}catch(o){console.log(o)}},[j,m]);h.useEffect(()=>{t||l("/")},[]);const E=e.jsxs(x,{spacing:3,alignItems:"center",children:[e.jsx(i,{name:"email",label:s("email"),placeholder:"example@gmail.com",InputLabelProps:{shrink:!0}}),e.jsx(B,{name:"otp"}),e.jsx(i,{name:"password",label:s("password"),type:a.value?"text":"password",InputProps:{endAdornment:e.jsx(f,{position:"end",children:e.jsx(g,{onClick:a.onToggle,edge:"end",children:e.jsx(d,{icon:a.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),e.jsx(i,{name:"password_confirmation",label:s("confirm-new-password"),type:a.value?"text":"password",InputProps:{endAdornment:e.jsx(f,{position:"end",children:e.jsx(g,{onClick:a.onToggle,edge:"end",children:e.jsx(d,{icon:a.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),e.jsx(H,{fullWidth:!0,color:"inherit",size:"large",type:"submit",variant:"contained",children:P?e.jsx(V,{color:(r==null?void 0:r.themeMode)==="dark"?"#161C24":"#ffffff",size:23}):s("send")}),e.jsxs(c,{variant:"body2",children:[e.jsxs("span",{children:[s("dont-have-code")," "]}),e.jsxs(w,{variant:"subtitle2",onClick:F,sx:{cursor:"pointer",...u&&{color:"text.disabled",pointerEvents:"none"}},children:[s("resend")," ",u&&`(${y}s)`]})]}),e.jsxs(w,{component:M,href:O.auth.amplify.login,color:"inherit",variant:"subtitle2",sx:{alignItems:"center",display:"inline-flex"},children:[e.jsx(d,{icon:"eva:arrow-ios-back-fill",width:16}),s("return-to")," ",s("sign-in")]})]}),L=e.jsxs(e.Fragment,{children:[e.jsx(W,{sx:{height:96}}),e.jsxs(x,{spacing:1,sx:{my:5},children:[e.jsx(c,{variant:"h3",children:s("success-request")}),e.jsxs(c,{variant:"body2",sx:{color:"text.secondary"},children:[s("pass-change-situations.first"),e.jsx("br",{}),s("pass-change-situations.last")]})]})]});return e.jsxs(z,{methods:p,onSubmit:S(k),children:[L,E]})}function le(){return e.jsxs(e.Fragment,{children:[e.jsx(G,{children:e.jsx("title",{children:"New Password"})}),e.jsx(ee,{})]})}export{le as default};
