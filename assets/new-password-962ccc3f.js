import{aV as k,aT as F,aU as L,a2 as R,aA as A,aB as r,aK as a,aY as E,aC as T,aL as $,r as q,j as s,S as u,aM as n,aW as N,$ as m,N as p,I as t,c as B,aN as H,T as i,L as h,R as V,p as _,aZ as W,aD as z,aE as M,aO as O,aP as D,aQ as K,aR as Q,aS as U,W as Y}from"./index-075f0922.js";import{a as Z}from"./use-countdown-d97f4719.js";import{u as G}from"./send-code-e93bc07c.js";function J(){const{newPassword:X,forgotPassword:x}=k();F(),L().get("email");const o=R(),{countdown:f,counting:d,startCountdown:c}=Z(60),w=A().shape({otp:r().required(a("auth-form.code")).min(6,a("auth-form.valid-code")),email:r().required(a("auth-form.email")).email(a("auth-form.valid-email")),password:r().required(a("auth-form.new-password")).min(6,a("auth-form.valid-password")),password_confirmation:r().required(a("auth-form.confirm-new-password")).oneOf([E("password")],a("auth-form.pass-match"))}),g={otp:"",email:"",password:"",password_confirmation:""},l=T({mode:"onChange",resolver:M(w),defaultValues:g}),{watch:as,handleSubmit:j,formState:{errors:es}}=l,{mutate:y}=G(),{mutate:b,error:os,isError:rs,isLoading:v}=$({mutationFn:e=>O.post(`${D}dashboard/restaurant/user/auth/changepassword`,e,{headers:{"Content-Type":"application/json","Accept-Language":K.language}}),onSuccess:e=>{navigate("auth/amplify/forgot-password"),Q(a("login-response"))},onError:e=>{U("eslam")}}),C=e=>{b(e)},P=q.useCallback(async()=>{try{c(),y()}catch(e){console.log(e)}},[x,c]),S=s.jsxs(u,{spacing:3,alignItems:"center",children:[s.jsx(n,{name:"email",label:a("email"),placeholder:"example@gmail.com",InputLabelProps:{shrink:!0}}),s.jsx(N,{name:"otp"}),s.jsx(n,{name:"password",label:a("password"),type:o.value?"text":"password",InputProps:{endAdornment:s.jsx(m,{position:"end",children:s.jsx(p,{onClick:o.onToggle,edge:"end",children:s.jsx(t,{icon:o.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),s.jsx(n,{name:"password_confirmation",label:a("confirm-new-password"),type:o.value?"text":"password",InputProps:{endAdornment:s.jsx(m,{position:"end",children:s.jsx(p,{onClick:o.onToggle,edge:"end",children:s.jsx(t,{icon:o.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),s.jsx(B,{fullWidth:!0,color:"inherit",size:"large",type:"submit",variant:"contained",children:v?s.jsx(H,{color:"#ffffff",size:23}):a("send")}),s.jsxs(i,{variant:"body2",children:[s.jsxs("span",{children:[a("dont-have-code")," "]}),s.jsxs(h,{variant:"subtitle2",onClick:P,sx:{cursor:"pointer",...d&&{color:"text.disabled",pointerEvents:"none"}},children:[a("resend")," ",d&&`(${f}s)`]})]}),s.jsxs(h,{component:V,href:_.auth.amplify.login,color:"inherit",variant:"subtitle2",sx:{alignItems:"center",display:"inline-flex"},children:[s.jsx(t,{icon:"eva:arrow-ios-back-fill",width:16}),a("return-to")," ",a("sign-in")]})]}),I=s.jsxs(s.Fragment,{children:[s.jsx(W,{sx:{height:96}}),s.jsxs(u,{spacing:1,sx:{my:5},children:[s.jsx(i,{variant:"h3",children:a("success-request")}),s.jsxs(i,{variant:"body2",sx:{color:"text.secondary"},children:[a("pass-change-situations.first"),s.jsx("br",{}),a("pass-change-situations.last")]})]})]});return s.jsxs(z,{methods:l,onSubmit:j(C),children:[I,S]})}function ds(){return s.jsxs(s.Fragment,{children:[s.jsx(Y,{children:s.jsx("title",{children:"New Password"})}),s.jsx(J,{})]})}export{ds as default};
