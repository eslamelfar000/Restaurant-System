import{eF as re,bc as oe,eG as ie,ba as le,eH as ce,bu as de,eg as ue,eI as pe,eJ as me,af as xe,bi as fe,bj as he,ef as ge,bl as je,bk as be,cG as R,cH as $,aY as ve,aA as ye,aB as S,eK as we,r as j,aC as Ce,aL as A,j as e,aD as _e,h as P,E as B,B as b,eB as Se,T as D,dR as Ie,G as Te,ay as M,n as Re,S as T,c as C,aM as q,cc as ke,eL as Fe,az as De,aN as H,aE as Ee,cv as Le,P as o,aO as V,aP as U,aQ as W,aR as J,aS as K,l as Ne,C as Pe,p as O,bV as Me,aG as qe,a2 as Oe,c3 as Q,A as ze,ad as Ge,N as $e,I as E,c4 as Ae,Q as z,O as Be,aK as He,$ as Ve}from"./index-e8afd095.js";import{C as Ue}from"./custom-breadcrumbs-c41d8ef9.js";import{G as k}from"./Grid2-45dd27b5.js";import{D as We}from"./DateTimePicker-9329ac6c.js";import{a as Je,g as Ke,C as Qe}from"./confirm-dialog-264b9cb5.js";import{D as Ye}from"./DialogTitle-53bb0472.js";import{D as Xe}from"./DialogContent-e8c6b00f.js";import{D as Ze}from"./DialogActions-9d60dd9f.js";import{T as et}from"./table-pagination-custom-e7ce1833.js";import{T as I}from"./TablePagination-e8e23f6f.js";function tt(n,t){return()=>null}function st(n,t){return()=>null}function nt(n,t,i,d,a){return null}const at={configure:n=>{re.configure(n)}},rt=Object.freeze(Object.defineProperty({__proto__:null,capitalize:oe,createChainedFunction:ie,createSvgIcon:le,debounce:ce,deprecatedPropType:tt,isMuiElement:de,ownerDocument:ue,ownerWindow:pe,requirePropFactory:st,setRef:me,unstable_ClassNameGenerator:at,unstable_useEnhancedEffect:xe,unstable_useId:fe,unsupportedProp:nt,useControlled:he,useEventCallback:ge,useForkRef:je,useIsFocusVisible:be},Symbol.toStringTag,{value:"Module"}));function Y({currentUser:n}){const{t}=R(),i=JSON.parse(localStorage.getItem("settings")),d=window.localStorage.getItem("user_data"),a=$(d),p=ve(),x=ye().shape({title:S().required(t("note-form.title")),status:S().required(t("note-form.status")),avatarUrl:S().required(t("note-form.image")),desc:S().required(t("note-form.desc")),date_time:we().when("status",(s,r)=>s==="pending"?r.required(t("note-form.date-time")):r.notRequired())}),v=j.useMemo(()=>({avatarUrl:"",title:"",status:"",desc:"",date_time:new Date("0000-00-00T00:00:00")||""}),[]),m=Ce({resolver:Ee(x),defaultValues:v}),{reset:f,watch:y,control:h,setValue:c,handleSubmit:l,formState:{errors:_}}=m,u=y(),w=[{value:"send_now",label:t("send-now")},{value:"pending",label:t("pending")}],[g,te]=j.useState(null),se=j.useCallback(s=>{const r=s[0];Object.assign(r,{preview:URL.createObjectURL(r)}),r&&r.type.startsWith("image/")&&te(r)},[]);j.useEffect(()=>{g&&c("avatarUrl",g,{shouldValidate:!0})},[c,g]);const{mutate:ne,error:ht,isError:gt,isLoading:N}=A({mutationFn:s=>V.post(`${U}dashboard/restaurant/notification/create`,s,{headers:{"Content-Type":"multipart/form-data","Accept-Language":W.language,Authorization:`Bearer ${a==null?void 0:a.token}`}}),onSuccess:()=>{J(t("note-form.success.create")),p("/dashboard/notifications/list"),f()},onError:()=>{K(t("error"))}}),ae=s=>{const r=new FormData;r.append("title",s==null?void 0:s.title),r.append("message",s==null?void 0:s.desc),g instanceof File&&r.append("photo",g),r.append("status",s==null?void 0:s.status),(s==null?void 0:s.status)==="pending"&&r.append("sent_at",Le(s==null?void 0:s.date_time,"yyyy-MM-dd HH:mm:ss")),ne(r)};return e.jsx(_e,{methods:m,onSubmit:l(ae),children:e.jsxs(k,{container:!0,spacing:3,children:[e.jsx(k,{xs:12,md:4,children:e.jsxs(P,{sx:{pt:10,pb:5,px:3},children:[n&&e.jsx(B,{color:u.status==="active"&&"success"||u.status==="banned"&&"error"||"warning",sx:{position:"absolute",top:24,right:24},children:u.status==="active"?t("active"):t("not-active")}),e.jsx(b,{sx:{mb:5},children:e.jsx(Se,{name:"avatarUrl",maxSize:3145728,onDrop:se,helperText:e.jsxs(D,{variant:"caption",sx:{mt:3,mx:"auto",display:"block",textAlign:"center",color:"text.disabled"},children:["Allowed *.jpeg, *.jpg, *.png, *.gif",e.jsx("br",{})," max size of ",Ie(3145728)]})})}),n&&e.jsx(Te,{labelPlacement:"start",control:e.jsx(M,{name:"status",control:h,render:({field:s})=>e.jsx(Re,{...s,checked:s.value!=="active",onChange:r=>s.onChange(r.target.checked?"banned":"active")})}),label:e.jsx(e.Fragment,{children:e.jsx(D,{variant:"subtitle2",sx:{mb:.5},children:t("status")})}),sx:{mx:0,mb:3,width:1,justifyContent:"space-between",alignItems:"center"}}),n&&e.jsx(T,{justifyContent:"center",alignItems:"center",sx:{mt:3},children:e.jsx(C,{variant:"soft",color:"error",children:t("del-note")})})]})}),e.jsx(k,{xs:12,md:8,children:e.jsxs(P,{sx:{p:3},children:[e.jsxs(b,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[e.jsx(q,{name:"title",label:t("title")}),e.jsxs(ke,{native:!0,name:"status",label:t("status"),InputLabelProps:{shrink:!0},children:[e.jsx("option",{value:"",hidden:!0,children:t("select-status")}),w.map((s,r)=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]}),(u==null?void 0:u.status)==="pending"&&e.jsx(b,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)"},sx:{mt:2},children:e.jsx(M,{control:h,name:"date_time",render:({field:s})=>e.jsxs(e.Fragment,{children:[e.jsx(We,{label:t("date-time"),...s,error:!!_.date_time,minDate:Fe(new Date,{days:1}),defaultValue:new Date}),_.date_time&&e.jsx(De,{sx:{mt:-2,color:"#e84f30"},children:t("note-form.date-time")})]})})}),e.jsx(b,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)"},sx:{mt:2},children:e.jsx(q,{rows:4,multiline:!0,name:"desc",label:t("note-details")})}),e.jsx(T,{spacing:3,alignItems:"flex-end",sx:{mt:3},children:e.jsx(C,{type:"submit",variant:"contained",disabled:!!N,children:N?e.jsx(H,{color:(i==null?void 0:i.themeMode)==="dark"?"#161C24":"#ffffff",size:23}):t("creat-note")})})]})})]})})}Y.propTypes={currentUser:o.object};function ot({id:n}){const t=Ne(),{_noteList:i}=Je(),{t:d}=R(),a=i.find(p=>p.id===n);return e.jsxs(Pe,{maxWidth:t.themeStretch?!1:"lg",children:[e.jsx(Ue,{heading:`${d("edit")} - ${a.title}`,links:[{name:d("dashboard"),href:O.dashboard.root},{name:d("notifications"),href:O.dashboard.notifications.root},{name:a==null?void 0:a.title}],sx:{mb:{xs:3,md:5}}}),e.jsx(Y,{currentUser:a})]})}ot.propTypes={id:o.string};var L={},X={exports:{}};(function(n){function t(i){return i&&i.__esModule?i:{default:i}}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports})(X);var it=X.exports,F={};const lt=Me(rt);var G;function ct(){return G||(G=1,function(n){"use client";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return t.createSvgIcon}});var t=lt}(F)),F}var dt=it;Object.defineProperty(L,"__esModule",{value:!0});var Z=L.default=void 0,ut=dt(ct()),pt=e,mt=(0,ut.default)((0,pt.jsx)("path",{d:"M7.11 8.53 5.7 7.11C4.8 8.27 4.24 9.61 4.07 11h2.02c.14-.87.49-1.72 1.02-2.47zM6.09 13H4.07c.17 1.39.72 2.73 1.62 3.89l1.41-1.42c-.52-.75-.87-1.59-1.01-2.47zm1.01 5.32c1.16.9 2.51 1.44 3.9 1.61V17.9c-.87-.15-1.71-.49-2.46-1.03L7.1 18.32zM13 4.07V1L8.45 5.55 13 10V6.09c2.84.48 5 2.94 5 5.91s-2.16 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93s-3.05-7.44-7-7.93z"}),"RotateLeft");Z=L.default=mt;function ee({title:n,content:t,action:i,open:d,meal:a,onClose:p,note_id:x,...v}){const{t:m}=R(),f=JSON.parse(localStorage.getItem("settings")),{refetch:y}=Ke(),h=window.localStorage.getItem("user_data"),c=$(h),{mutate:l,error:_,isError:u,isLoading:w}=A({mutationFn:()=>V.post(`${U}dashboard/restaurant/notification/send`,{id:x},{headers:{"Content-Type":"multipart/form-data","Accept-Language":W.language,Authorization:`Bearer ${c==null?void 0:c.token}`}}),onSuccess:()=>{J(m("note-form.success.")),p(),y()},onError:()=>{K(m("error"))}});return e.jsxs(qe,{fullWidth:!0,maxWidth:"xs",open:d,onClose:p,...v,children:[e.jsx(b,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsx(Ye,{sx:{pb:2,fontSize:"22px !important"},children:n})}),t&&e.jsxs(Xe,{sx:{typography:"body2",overflow:"hidden",fontSize:"17px"},children:[" ",t," "]}),e.jsxs(Ze,{children:[e.jsx(C,{type:"submit",variant:"contained",color:"success",disabled:!!w,onClick:l,children:w?e.jsx(H,{color:(f==null?void 0:f.themeMode)==="dark"?"#161C24":"#ffffff",size:23}):m("resend")}),e.jsx(C,{variant:"outlined",color:"inherit",onClick:p,children:m("cancel")})]})]})}ee.propTypes={action:o.node,content:o.node,onClose:o.func,open:o.bool,title:o.string};function xt({row:n,selected:t,onEditRow:i,onSelectRow:d,onDeleteRow:a}){const{avatarUrl:p,status:x,title:v,desc:m,id:f,time:y}=n,h=Oe(),c=Q(),{t:l}=R(),[_,u]=j.useState(!1),w=()=>{u(!0)},g=()=>{u(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(et,{hover:!0,selected:t,children:[e.jsx(I,{children:e.jsxs(b,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ze,{alt:v,src:p,sx:{mr:2,width:50,height:50}}),e.jsxs(b,{children:[e.jsx(Ge,{primary:v,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled"}}),e.jsx(D,{children:y?`( ${y} )`:""})]})]})}),e.jsx(I,{sx:{width:"400px",whiteSpace:"normal",wordWrap:"break-word"},children:e.jsx("p",{children:m})}),e.jsx(I,{children:e.jsx(B,{variant:"soft",color:x==="send_now"&&"success"||x==="pending"&&"warning"||"default",children:l(x==="send_now"?"sent-success":"pending")})}),e.jsx(I,{align:"right",sx:{px:1,whiteSpace:"nowrap"},children:e.jsx($e,{color:c.open?"inherit":"default",onClick:c.onOpen,children:e.jsx(E,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(Ae,{open:c.open,onClose:c.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(z,{onClick:()=>{h.onTrue(),c.onClose()},sx:{color:"error.main"},children:[e.jsx(E,{icon:"solar:trash-bin-trash-bold"}),l("delete")]}),x==="send_now"&&e.jsxs(z,{onClick:()=>{w(),c.onClose()},children:[e.jsx(Z,{}),l("resend-note")]})]}),e.jsx(Qe,{open:h.value,onClose:h.onFalse,note_id:f,title:l("delete"),content:l("del-note-question"),action:e.jsx(C,{variant:"contained",color:"error",onClick:a,children:l("delete")})}),e.jsx(ee,{open:_,onClose:g,note_id:f,title:l("resend"),content:l("resend-note-question"),action:e.jsx(C,{variant:"contained",color:"error",onClick:a,children:l("resend")})})]})}xt.propTypes={onDeleteRow:o.func,onEditRow:o.func,onSelectRow:o.func,row:o.object,selected:o.bool};function ft({filters:n,onFilters:t,roleOptions:i}){Q();const d=j.useCallback(a=>{t("title",a.target.value)},[t]);return j.useCallback(a=>{t("role",typeof a.target.value=="string"?a.target.value.split(","):a.target.value)},[t]),e.jsx(e.Fragment,{children:e.jsx(T,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2,md:2}},children:e.jsx(T,{direction:"row",alignItems:"center",spacing:0,flexGrow:1,sx:{width:1},children:e.jsx(Be,{fullWidth:!0,value:n.name,onChange:d,placeholder:`${He("search")}...`,InputProps:{startAdornment:e.jsx(Ve,{position:"start",children:e.jsx(E,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})})})}ft.propTypes={filters:o.object,onFilters:o.func,roleOptions:o.array};export{ft as N,xt as a,Y as b,ot as c};
