import{aV as L,aY as A,a2 as R,aA as N,aB as n,aK as s,aZ as T,aC as $,aL as q,r as p,j as e,S as h,aM as t,aW as _,$ as x,N as f,I as i,c as B,aN as H,T as d,L as w,R as V,p as M,a_ as W,aD as z,aE as O,aO as D,aP as K,aQ as Q,aR as Y,aS as Z,W as G}from"./index-8dd84c3c.js";import{a as J}from"./use-countdown-34df3017.js";import{u as U}from"./send-code-93cf7b49.js";function X(){const{newPassword:ee,forgotPassword:g}=L(),c=A(),r=window.localStorage.getItem("code-email"),a=R(),{countdown:j,counting:l,startCountdown:u}=J(60),y=N().shape({otp:n().required(s("auth-form.code")).min(6,s("auth-form.valid-code")),email:n().required(s("auth-form.email")).email(s("auth-form.valid-email")),password:n().required(s("auth-form.new-password")).min(6,s("auth-form.valid-password")),password_confirmation:n().required(s("auth-form.confirm-new-password")).oneOf([T("password")],s("auth-form.pass-match"))}),b={otp:"",email:r||"",password:"",password_confirmation:""},m=$({mode:"onChange",resolver:O(y),defaultValues:b}),{watch:se,handleSubmit:v,formState:{errors:ae}}=m,{mutate:C}=U(),{mutate:S,error:oe,isError:ne,isLoading:I}=q({mutationFn:o=>D.post(`${K}dashboard/restaurant/user/auth/changepassword`,o,{headers:{"Content-Type":"application/json","Accept-Language":Q.language}}),onSuccess:()=>{c("/"),Y(s("send-code-success")),window.localStorage.removeItem("code-email")},onError:o=>{Z(s("send-code-error"))}}),P=o=>{S(o)},k=p.useCallback(async()=>{try{u(),C({email:r})}catch(o){console.log(o)}},[g,u]);p.useEffect(()=>{r||c("/")},[]);const F=e.jsxs(h,{spacing:3,alignItems:"center",children:[e.jsx(t,{name:"email",label:s("email"),placeholder:"example@gmail.com",InputLabelProps:{shrink:!0}}),e.jsx(_,{name:"otp"}),e.jsx(t,{name:"password",label:s("password"),type:a.value?"text":"password",InputProps:{endAdornment:e.jsx(x,{position:"end",children:e.jsx(f,{onClick:a.onToggle,edge:"end",children:e.jsx(i,{icon:a.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),e.jsx(t,{name:"password_confirmation",label:s("confirm-new-password"),type:a.value?"text":"password",InputProps:{endAdornment:e.jsx(x,{position:"end",children:e.jsx(f,{onClick:a.onToggle,edge:"end",children:e.jsx(i,{icon:a.value?"solar:eye-bold":"solar:eye-closed-bold"})})})}}),e.jsx(B,{fullWidth:!0,color:"inherit",size:"large",type:"submit",variant:"contained",children:I?e.jsx(H,{color:(mode==null?void 0:mode.themeMode)==="dark"?"#161C24":"#ffffff",size:23}):s("send")}),e.jsxs(d,{variant:"body2",children:[e.jsxs("span",{children:[s("dont-have-code")," "]}),e.jsxs(w,{variant:"subtitle2",onClick:k,sx:{cursor:"pointer",...l&&{color:"text.disabled",pointerEvents:"none"}},children:[s("resend")," ",l&&`(${j}s)`]})]}),e.jsxs(w,{component:V,href:M.auth.amplify.login,color:"inherit",variant:"subtitle2",sx:{alignItems:"center",display:"inline-flex"},children:[e.jsx(i,{icon:"eva:arrow-ios-back-fill",width:16}),s("return-to")," ",s("sign-in")]})]}),E=e.jsxs(e.Fragment,{children:[e.jsx(W,{sx:{height:96}}),e.jsxs(h,{spacing:1,sx:{my:5},children:[e.jsx(d,{variant:"h3",children:s("success-request")}),e.jsxs(d,{variant:"body2",sx:{color:"text.secondary"},children:[s("pass-change-situations.first"),e.jsx("br",{}),s("pass-change-situations.last")]})]})]});return e.jsxs(z,{methods:m,onSubmit:v(P),children:[E,F]})}function de(){return e.jsxs(e.Fragment,{children:[e.jsx(G,{children:e.jsx("title",{children:"New Password"})}),e.jsx(X,{})]})}export{de as default};
