import{l as I,a2 as L,r as n,e_ as C,j as e,S,p as x,eZ as k,eY as E,df as G,f2 as _,C as q,c as B,R as N,I as P,e1 as g,W as A}from"./index-e8afd095.js";import{o as T}from"./orderBy-96adae51.js";import{E as D}from"./empty-content-1749e367.js";import{C as U}from"./custom-breadcrumbs-c41d8ef9.js";import{a as V,b as W,c as Y,d as Z,e as z}from"./tour-details-view-e0c19768.js";import"./_baseToString-3e059b9f.js";import"./_baseIteratee-b0b0c697.js";import"./_baseEach-9ded759e.js";import"./custom-date-range-picker-746e8f84.js";import"./DialogTitle-53bb0472.js";import"./dialogTitleClasses-033b5ad4.js";import"./DialogContent-e8c6b00f.js";import"./useMobilePicker-84a04693.js";import"./DialogActions-9d60dd9f.js";import"./ListItem-5385a5b1.js";import"./ListItemSecondaryAction-edfa5c47.js";import"./DatePicker-3f2abcf9.js";import"./Pagination-2c7b5dd7.js";import"./FirstPage-9e752ddf.js";import"./Grid2-45dd27b5.js";import"./CardHeader-1ba1339f.js";import"./LoadingButton-d7ef52be.js";import"./CircularProgress-10c633d6.js";import"./markdown-801deacb.js";import"./lightbox-195bc996.js";const y={destination:[],tourGuides:[],services:[],startDate:null,endDate:null};function H(){const t=I(),d=L(),[a,j]=n.useState("latest"),[i,c]=n.useState({query:"",results:[]}),[s,u]=n.useState(y),p=s.startDate&&s.endDate?s.startDate.getTime()>s.endDate.getTime():!1,l=J({inputData:C,filters:s,sortBy:a,dateError:p}),r=!!s.destination.length||!!s.tourGuides.length||!!s.services.length||!!s.startDate&&!!s.endDate,m=!l.length&&r,b=n.useCallback((o,h)=>{u(f=>({...f,[o]:h}))},[]),O=n.useCallback(o=>{j(o)},[]),R=n.useCallback(o=>{if(c(h=>({...h,query:o})),o){const h=C.filter(f=>f.name.toLowerCase().indexOf(i.query.toLowerCase())!==-1);c(f=>({...f,results:h}))}},[i.query]),F=n.useCallback(()=>{u(y)},[]),v=e.jsxs(S,{spacing:3,justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},direction:{xs:"column",sm:"row"},children:[e.jsx(V,{query:i.query,results:i.results,onSearch:R,hrefItem:o=>x.dashboard.tour.details(o)}),e.jsxs(S,{direction:"row",spacing:1,flexShrink:0,children:[e.jsx(W,{open:d.value,onOpen:d.onTrue,onClose:d.onFalse,filters:s,onFilters:b,canReset:r,onResetFilters:F,serviceOptions:k.map(o=>o.label),tourGuideOptions:E,destinationOptions:G,dateError:p}),e.jsx(Y,{sort:a,onSort:O,sortOptions:_})]})]}),w=e.jsx(Z,{filters:s,onResetFilters:F,canReset:r,onFilters:b,results:l.length});return e.jsxs(q,{maxWidth:t.themeStretch?!1:"lg",children:[e.jsx(U,{heading:"List",links:[{name:"Dashboard",href:x.dashboard.root},{name:"Tour",href:x.dashboard.tour.root},{name:"List"}],action:e.jsx(B,{component:N,href:x.dashboard.tour.new,variant:"contained",startIcon:e.jsx(P,{icon:"mingcute:add-line"}),children:"New Tour"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(S,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:[v,r&&w]}),m&&e.jsx(D,{title:"No Data",filled:!0,sx:{py:10}}),e.jsx(z,{tours:l})]})}const J=({inputData:t,filters:d,sortBy:a,dateError:j})=>{const{services:i,destination:c,startDate:s,endDate:u,tourGuides:p}=d,l=p.map(r=>r.id);return a==="latest"&&(t=T(t,["createdAt"],["desc"])),a==="oldest"&&(t=T(t,["createdAt"],["asc"])),a==="popular"&&(t=T(t,["totalViews"],["desc"])),j||s&&u&&(t=t.filter(r=>g(r.available.startDate)>=g(s)&&g(r.available.endDate)<=g(u))),c.length&&(t=t.filter(r=>c.includes(r.destination))),l.length&&(t=t.filter(r=>r.tourGuides.some(m=>l.includes(m.id)))),i.length&&(t=t.filter(r=>r.services.some(m=>i.includes(m)))),t};function Te(){return e.jsxs(e.Fragment,{children:[e.jsx(A,{children:e.jsx("title",{children:" Dashboard: Tour List"})}),e.jsx(H,{})]})}export{Te as default};
